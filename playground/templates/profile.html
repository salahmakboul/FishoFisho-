{% extends 'main.html' %}
{% block content %}

<div class="profile-container">
    <!-- Profile Header -->
    <div class="profile-header">
        {% if user.userprofile.avatar %}
        <img src="{{ user.userprofile.avatar.url }}" alt="{{ user.username }}"
            style="width: 100px; height: 100px; border-radius: 50%; object-fit: cover; border: 4px solid white; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
        {% else %}
        <div
            style="width: 150px; height: 150px; border-radius: 50%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); display: flex; align-items: center; justify-content: center; margin: 0 auto; color: white; font-size: 3rem; font-weight: bold;">
            {{ user.username|first|upper }}
        </div>
        {% endif %}
        <h1>{{ user.username }}</h1>
        <div class="profile-subtitle">@{{ user.username }} â€¢ Joined {{ user.date_joined|date:"F Y" }}</div>

        <div class="profile-stats">
            <div class="stat-item">
                <span class="stat-value">{{ rooms.count }}</span>
                <span class="stat-label">Rooms Created</span>
            </div>
            <div class="stat-item">
                <span class="stat-value">{{ user_messages.count }}</span>
                <span class="stat-label">Messages</span>
            </div>
            <div class="stat-item">
                <span class="stat-value">{{ participants_count }}</span>
                <span class="stat-label">Participating</span>
            </div>
        </div>

        {% if request.user == user %}
        <div class="profile-actions">
            <a href="{% url 'edit-profile' %}"
                style="display: inline-block; padding: 0.5rem 1rem; background: #4F46E5; color: white; border-radius: 6px; text-decoration: none;">
                 Edit Profile
            </a>  
            <button class="profile-btn profile-btn--secondary">Share Profile</button>
        </div>
        {% endif %}
    </div>

    <!-- Left Column - Topics -->
    <div>
        {% include 'topics_component.html' %}
    </div>

    <!-- Center Column - Feed -->
    <div>
        <!-- Profile Bio Card -->
        <div class="profile-card profile-bio">
            <h3 class="profile-card-title">About</h3>
            <div class="bio-content">
                {{ user.userprofile.bio }}
                
            </div>
            <div class="bio-meta">
                <div class="bio-meta-item">
                    <svg viewBox="0 0 24 24">
                        <path
                            d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z" />
                    </svg>
                    <span>Location not set</span>
                </div>
                <div class="bio-meta-item">
                    <svg viewBox="0 0 24 24">
                        <path
                            d="M19 4h-1V2h-2v2H8V2H6v2H5c-1.11 0-1.99.9-1.99 2L3 20c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 16H5V10h14v10zM5 6v2h14V6H5z" />
                    </svg>
                    <span>Joined {{ user.date_joined|date:"M Y" }}</span>
                </div>
            </div>
        </div>

        <!-- Feed Content -->
        <div class="profile-card">
            <h3 class="profile-card-title">Recent Activity</h3>
            {% if rooms.count > 0 %}
            {% include 'feed_component.html' %}
            {% else %}
            <div class="empty-state">
                <div class="empty-state-icon">
                    <svg viewBox="0 0 24 24">
                        <path
                            d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 14H4V8l8 5 8-5v10zm-8-7L4 6h16l-8 5z" />
                    </svg>
                </div>
                <h4 class="empty-state-title">No rooms created yet</h4>
                <p class="empty-state-description">When {{ user.username }} creates rooms, they will appear here.</p>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- Right Column - Activity -->
    <div>
        {% include 'activity_component.html' %}
    </div>
</div>

{% endblock content %}